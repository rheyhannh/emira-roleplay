local a,b,c,d=GetCurrentResourceName(),{},{},0;RPC={}function ClearPromise(e)Citizen.SetTimeout(5000,function()b[e]=nil end)end;function ParamPacker(...)local f,g={...},{}for h=1,15,1 do g[h]={param=f[h]}end;return g end;function ParamUnpacker(f,i)local j=i or 1;if j<=#f then return f[j]["param"],ParamUnpacker(f,j+1)end end;function UnPacker(f,i)local j=i or 1;if j<=15 then return f[j],UnPacker(f,j+1)end end;function RPC.execute(k,l,...)local e,m=d,false;d=d+1;b[e]=promise:new()TriggerClientEvent("nopixel:rpc:request",k,a,l,e,ParamPacker(...),true)Citizen.SetTimeout(20000,function()if not m then b[e]:resolve({nil})print("RPC Client Timeout | Resource: "..a.." Event: "..l)end end)local n=Citizen.Await(b[e])m=true;ClearPromise(e)return ParamUnpacker(n)end;RegisterNetEvent("nopixel:rpc:response")AddEventHandler("nopixel:rpc:response",function(o,e,n)if a==o and b[e]then b[e]:resolve(n)end end)function RPC.register(l,p)c[l]=p end;function RPC.remove(l)c[l]=nil end;RegisterNetEvent("nopixel:rpc:request")AddEventHandler("nopixel:rpc:request",function(o,l,e,f,q)local k=source;local n;if c[l]==nil then return end;local r,s=pcall(function()if q then n=ParamPacker(c[l](k,ParamUnpacker(f)))else n=ParamPacker(c[l](k,UnPacker(f)))end end)if not r then print("RPC Client Error | Resource: "..a.." Event: "..l.." Origin: "..o.." Error: "..s)end;if n==nil then n={}end;TriggerClientEvent("nopixel:rpc:response",k,o,e,n)end)RegisterNetEvent("rpc:server:timeout")AddEventHandler("rpc:server:timeout",function(a,l)end)RegisterNetEvent("rpc:client:error")AddEventHandler("rpc:client:error",function(a,o,l,s)end)