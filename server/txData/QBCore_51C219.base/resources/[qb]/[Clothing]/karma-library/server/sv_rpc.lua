local a,b,c,d=GetCurrentResourceName(),{},{},0;RPC={}function ClearPromise(e)Citizen.SetTimeout(5000,function()b[e]=nil end)end;function ParamPacker(...)local f,g={...},{}for h=1,15,1 do g[h]={param=f[h]}end;return g end;function ParamUnpacker(f,i)local j=i or 1;if j<=#f then return f[j]["param"],ParamUnpacker(f,j+1)end end;function UnPacker(f,i)local j=i or 1;if j<=15 then return f[j],UnPacker(f,j+1)end end;function RPC.register(k,l)c[k]=l end;function RPC.remove(k)c[k]=nil end;function RPC.execute(k,...)local e,m=d,false;d=d+1;b[e]=promise:new()TriggerClientEvent("rpc:request",a,k,e,ParamPacker(...))Citizen.SetTimeout(20000,function()if not m then b[e]:resolve({nil})end end)local n=Citizen.Await(b[e])m=true;ClearPromise(e)return ParamUnpacker(n)end;RegisterServerEvent("rpc:response")AddEventHandler("rpc:response",function(o,e,n,p)if a==o and b[e]then b[e]:resolve(n)end end)RegisterServerEvent("rpc:server:timeout")AddEventHandler("rpc:server:timeout",function(o,k)print("RPC [Timeout]",o,k)end)RegisterServerEvent("rpc:client:error")AddEventHandler("rpc:client:error",function(a,o,k,q)print("RPC [Error]",a,o,k,q)end)RegisterServerEvent("rpc:request")AddEventHandler("rpc:request",function(o,k,e,f,p)local r=source;local n;if c[k]==nil then return end;local s,q=pcall(function()if packaged then n=ParamPacker(c[k](r,ParamUnpacker(f)))else n=ParamPacker(c[k](r,UnPacker(f)))end end)if not s then TriggerClientEvent("rpc:client:error",r,a,o,k,q)end;if n==nil then n={}end;TriggerClientEvent("rpc:response",r,o,e,n)end)