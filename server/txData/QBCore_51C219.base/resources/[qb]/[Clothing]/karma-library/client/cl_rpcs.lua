local a,b,c,d=GetCurrentResourceName(),{},{},0;RPC={}function ClearPromise(e)Citizen.SetTimeout(5000,function()b[e]=nil end)end;function ParamPacker(...)local f,g={...},{}for h=1,15,1 do g[h]={param=f[h]}end;return g end;function ParamUnpacker(f,i)local j=i or 1;if j<=#f then return f[j]["param"],ParamUnpacker(f,j+1)end end;function UnPacker(f,i)local j=i or 1;if j<=15 then return f[j],UnPacker(f,j+1)end end;function TriggerNetEvent(k,...)local l=msgpack.pack({...})if l:len()<5000 then TriggerServerEventInternal(k,l,l:len())else TriggerLatentServerEventInternal(k,l,l:len(),128000)end end;function RPC.execute(m,...)local e,n=d,false;d=d+1;b[e]=promise:new()TriggerNetEvent("nopixel:rpc:request",a,m,e,ParamPacker(...),true)Citizen.SetTimeout(20000,function()if not n then b[e]:resolve({nil})TriggerServerEvent("rpc:server:timeout",a,m)end end)local o=Citizen.Await(b[e])n=true;ClearPromise(e)return ParamUnpacker(o)end;function RPC.executeLatent(m,p,...)local e,n=d,false;d=d+1;b[e]=promise:new()TriggerLatentServerEvent("rpc:latent:request",50000,a,m,e,ParamPacker(...),true)Citizen.SetTimeout(p,function()if not n then b[e]:resolve({nil})TriggerServerEvent("rpc:server:timeout",a,m)end end)local o=Citizen.Await(b[e])n=true;ClearPromise(e)return ParamUnpacker(o)end;RegisterNetEvent("nopixel:rpc:response")AddEventHandler("nopixel:rpc:response",function(q,e,o)if a==q and b[e]then b[e]:resolve(o)end end)function RPC.register(m,r)c[m]=r end;function RPC.remove(m)c[m]=nil end;RegisterNetEvent("nopixel:rpc:request")AddEventHandler("nopixel:rpc:request",function(q,m,e,f)local o;if c[m]==nil then return end;local s,t=pcall(function()if packaged then o=ParamPacker(c[m](ParamUnpacker(f)))else o=ParamPacker(c[m](UnPacker(f)))end end)if not s then TriggerServerEvent("rpc:client:error",a,q,m,t)end;if o==nil then o={}end;TriggerNetEvent("nopixel:rpc:response",q,e,o,true)end)RegisterNetEvent("rpc:latent:request")AddEventHandler("rpc:latent:request",function(q,m,e,f)local o;if c[m]==nil then return end;local s,t=pcall(function()if packaged then o=ParamPacker(c[m](ParamUnpacker(f)))else o=ParamPacker(c[m](UnPacker(f)))end end)if not s then TriggerServerEvent("rpc:client:error",a,q,m,t)end;if o==nil then o={}end;TriggerLatentServerEvent("nopixel:rpc:response",50000,q,e,o,true)end)